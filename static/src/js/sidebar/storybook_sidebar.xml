<?xml version="1.0" encoding="UTF-8" ?>

<templates>
    <t t-name="storybook.StorybookSidebar" owl="1">
        <div class="o_storybook_sidebar overflow-auto bg-white border-end">
            <ul class="pt-2" >
                <li t-foreach="stories.stories" t-as="moduleName" t-key="moduleName">
                    <t t-call="storybook.StorybookSidebar.module"/>
                </li>
            </ul>
        </div>
    </t>

    <t t-name="storybook.StorybookSidebar.module" owl="1">
        <t t-set="moduleObject" t-value="stories.stories[moduleName]" />
        <div t-on-click="() => this.toggleFold(moduleObject)" class="d-flex align-items-center o_storybook_module o_storybook_hover text-uppercase text-muted user-select-none">
            <button class="btn btn-link p-0">
                <i t-att-class="(!moduleObject['folded'] ? 'fa-caret-down' : 'fa-caret-right') + ' fa o_storybook_caret align-self-center' "></i> 
            </button>
            
            <t t-esc="moduleName"/>
        </div>
        <t t-if="!moduleObject['folded']">
            <ul>
                <li t-foreach="moduleObject['folders']" t-as="folderName" t-key="folderName">
                    <t t-call="storybook.StorybookSidebar.folder"/>
                </li>
            </ul>                  
        </t>
        
    </t>

    <t t-name="storybook.StorybookSidebar.folder" owl="1">
        <t t-set="folderObject" t-value="moduleObject['folders'][folderName]" />
        <div t-on-click="() => this.toggleFold(folderObject)" class="d-flex align-items-center o_storybook_folder o_storybook_hover user-select-none ps-4 pb-1">
            <button class="btn btn-link p-0">
                <i t-att-class="(!folderObject['folded'] ? 'fa-folder-open' : 'fa-folder') + ' fa' "></i> 
            </button>
            <t t-esc="folderName"/> 
        </div>
        <t t-if="!folderObject['folded']">
            <ul>
                <li t-foreach="folderObject['stories']" t-as="story" t-key="story">
                    <div t-on-click="() => this.onStoryClick(story)" t-att-class="story.id === stories.active.id ? 'o_storybook_active' : ''" class="d-flex align-items-center o_storybook_item o_storybook_hover ps-5 pb-1">
                        <button class="btn btn-link p-0">
                            <i class="fa fa-bookmark"></i>
                        </button>
                        <t t-esc="story.name"/> 
                    </div>
                </li>
            </ul>
        </t>
    </t>
</templates>
